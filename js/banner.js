// Generated by CoffeeScript 1.8.0
(function() {
  var banner, bannerImg, isBannerClosed, setTransition, sizeBanner;

  bannerImg = $("#post-banner");

  banner = $("div.post.banner");

  isBannerClosed = true;


  /*
  Size the banner before the image has loaded
  Because it doesn't depend on the image size
  And it's jarring if this doesn't happen
   */

  banner.css({
    "height": banner.width() / 5
  });

  $(bannerImg).load(function() {
    return sizeBanner($(this), true);
  });

  $(window).resize(function() {
    return sizeBanner(bannerImg, isBannerClosed);
  });

  banner.click(function() {
    setTransition(true);
    setTimeout((function() {
      return setTransition(false);
    }), 200);
    if (isBannerClosed) {
      banner.css({
        "height": bannerImg.height()
      });
      bannerImg.css({
        "margin-top": 0
      });
      banner.find(".banner-content").css({
        "opacity": 0
      });
    } else {
      sizeBanner(bannerImg, true);
      banner.find(".banner-content").css({
        "opacity": 1
      });
    }
    return isBannerClosed = !isBannerClosed;
  });

  sizeBanner = function(b, closed) {
    var bannerPosition, h;
    h = b.height();
    bannerPosition = banner.attr("bannerPosition");
    if (closed) {
      banner.css({
        "height": banner.width() / 5
      });
      return b.css({
        "margin-top": -bannerPosition * h
      });
    } else {
      return banner.css({
        "height": bannerImg.height()
      });
    }
  };

  setTransition = function(enable) {
    if (enable) {
      banner.css({
        "-webkit-transition": "height 200ms",
        "   -moz-transition": "height 200ms",
        "    -ms-transition": "height 200ms",
        "     -o-transition": "height 200ms",
        "        transition": "height 200ms"
      });
      return bannerImg.css({
        "-webkit-transition": "margin-top 200ms",
        "   -moz-transition": "margin-top 200ms",
        "    -ms-transition": "margin-top 200ms",
        "     -o-transition": "margin-top 200ms",
        "        transition": "margin-top 200ms"
      });
    } else {
      banner.css({
        "-webkit-transition": "none",
        "   -moz-transition": "none",
        "    -ms-transition": "none",
        "     -o-transition": "none",
        "        transition": "none"
      });
      return bannerImg.css({
        "-webkit-transition": "none",
        "   -moz-transition": "none",
        "    -ms-transition": "none",
        "     -o-transition": "none",
        "        transition": "none"
      });
    }
  };

}).call(this);
